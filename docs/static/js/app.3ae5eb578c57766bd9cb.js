webpackJsonp([1],{"0gDO":function(e,t){Math.clamp=function(e,t,i){return Math.max(t,Math.min(i,e))},Math.map=function(e,t,i,s,a){return s+(e-t)*(a-s)/(i-t)}},IBSi:function(e,t,i){"use strict";(function(e){var s=i("Zx67"),a=i.n(s),n=i("Zrlr"),r=i.n(n),o=i("wxAW"),l=i.n(o),u=i("zwoO"),c=i.n(u),d=i("Pf15"),h=i.n(d),p=i("xkEE"),m=function(t){function i(e,t,s,n,o){r()(this,i);var l=c()(this,(i.__proto__||a()(i)).call(this));return l.modelUrl=e,l.scale=t,l.rotation=s,l.audioUrl=n,l.audioListener=o,l.model=null,l.sound=null,l.loadModel(),l.loadAudio(),l}return h()(i,t),l()(i,[{key:"loadModel",value:function(){var e=this;(new p.a).load("static/models/"+e.modelUrl,function(t){e.model=t.scene.children[0].clone(),e.model.scale.set(e.scale,e.scale,e.scale),e.model.lookAt(0,e.rotation,0)},function(e){},function(e){console.error("GLTF LOADER:",e)})}},{key:"loadAudio",value:function(){var t=this;this.sound=new e.Audio(this.audioListener),(new e.AudioLoader).load(this.audioUrl,function(e){t.sound.setBuffer(e),t.sound.setLoop(!1),t.sound.setVolume(.5)})}}]),i}(i("vzCy"));t.a=m}).call(t,i("Ml+6"))},eslX:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i("pTlp");var s=i("Zrlr"),a=i.n(s),n=i("wxAW"),r=i.n(n),o=i("Ml+6"),l=i("od15"),u=i("Zx67"),c=i.n(u),d=i("zwoO"),h=i.n(d),p=i("Pf15"),m=i.n(p),f=i("xkEE"),v=function(e){function t(e,i,s,n,r,l,u){a()(this,t);var d=h()(this,(t.__proto__||c()(t)).call(this));return d.modelUrl=e,d.scale=i,d.rotation=s,d.velocity=n,d.audioUrl=r,d.audioListener=l,d.audioPlay=u,d.model=null,d.sound=null,d.center=new o.Vector3(0,0,0),d.loadModel(),d.loadAudio(),d}return m()(t,e),r()(t,[{key:"loadModel",value:function(){var e=this;(new f.a).load("static/models/"+this.modelUrl,function(t){e.model=t.scene.children[0],e.model.scale.set(e.scale,e.scale,e.scale),e.center=(new o.Box3).setFromObject(e.model).getCenter(),e.emit("onModelLoaded",e.model)},function(e){},function(e){console.error("GLTF LOADER:",e)})}},{key:"loadAudio",value:function(){var e=this;this.sound=new o.Audio(this.audioListener),(new o.AudioLoader).load(this.audioUrl,function(t){e.sound.setBuffer(t),e.sound.setLoop(!0),e.sound.setVolume(.3),e.audioPlay&&e.sound.play()})}}]),t}(i("vzCy")),g=function(e){function t(e){return a()(this,t),h()(this,(t.__proto__||c()(t)).call(this,"parachute.gltf",2.5,0,1,"static/audios/205966__kangaroovindaloo__medium-wind.ogg",e,!0))}return m()(t,e),t}(v),M=function(e){function t(e){return a()(this,t),h()(this,(t.__proto__||c()(t)).call(this,"plane.gltf",6,Math.PI+.5*Math.PI,2,"static/audios/218352__photomonster__motorcycle-nsumax-1954-engine.ogg",e,!1))}return m()(t,e),t}(v),y=function(e){function t(e){return a()(this,t),h()(this,(t.__proto__||c()(t)).call(this,"spaceship.gltf",30,Math.PI,3,"static/audios/42233__noisecollector__spaceswamp.ogg",e,!1))}return m()(t,e),t}(v),L=function(e){function t(e){return a()(this,t),h()(this,(t.__proto__||c()(t)).call(this,"coin.gltf",30,1,"static/audios/135936__bradwesson__collectcoin.ogg",e))}return m()(t,e),t}(i("IBSi").a),S=(i("0gDO"),function(e){function t(e,i){a()(this,t);var s=h()(this,(t.__proto__||c()(t)).call(this));s._scene=e,s._camera=i,s.prevCamX=0,s.prevCamY=0,s.prevCamZ=0,s.maxParticles=1e3,s.spread=300,s.particles=new o.Geometry;for(var n=0;n<s.maxParticles;n++){var r=new o.Vector3(Math.random()*s.spread-.5*s.spread,Math.random()*s.spread-.5*s.spread,Math.random()*s.spread-.5*s.spread);s.particles.vertices.push(r)}var l=new o.PointsMaterial({color:16777215,size:2,map:o.ImageUtils.loadTexture("static/textures/particle.png"),blending:o.AdditiveBlending,transparent:!0});return s.particleSystem=new o.Points(s.particles,l),s.particleSystem.sortParticles=!0,s._scene.add(s.particleSystem),s}return m()(t,e),r()(t,[{key:"set",value:function(e){}},{key:"update",value:function(){var e=this._camera.position.x-this.prevCamX,t=this._camera.position.y-this.prevCamY,i=this._camera.position.z-this.prevCamZ;this.prevCamX=this._camera.position.x,this.prevCamY=this._camera.position.y,this.prevCamZ=this._camera.position.z,this.particleSystem.position.set(this._camera.position.x,this._camera.position.y,this._camera.position.z);for(var s=0;s<this.particleSystem.geometry.vertices.length;s++){var a=this.particleSystem.geometry.vertices[s];a.x-=e,a.y-=t,a.z-=i,a.z<-30&&(a.x=Math.random()*this.spread-.5*this.spread,a.y=Math.random()*this.spread-.5*this.spread,a.z=300+60*Math.random())}this.particleSystem.geometry.verticesNeedUpdate=!0}}]),t}(i("vzCy")));new(function(){function e(){a()(this,e);var t=this;this.currentLevel=0,this.mouseX=0,this.mouseY=0,this.prevMouseX=this.mouseX,this.prevMouseY=this.mouseY,this.diffX=0,this.diffY=0,this.audioList=[{url:"static/audios/Black-Eyed-Peas-I-Got-A-Feeling.ogg",sound:null},{url:"static/audios/Eiffel65-Blue.ogg",sound:null},{url:"static/audios/Enegetic-Game-Theme.ogg",sound:null},{url:"static/audios/Imagine Dragons - Radioactive (Harder).ogg",sound:null}],this.audioListener=new o.AudioListener,this.maxX=80,this.maxY=50,this.velX=1.5,this.minAltitude=200,this.altitude=this.minAltitude,this.curAltitude=this.altitude,this.destPos=new o.Vector2,this.raycaster=new o.Raycaster,this.raycaster.far=2,this.direction=new o.Vector3(0,0,10),this.direction.normalize(),this.coins=[],this.coin=new L(this.audioListener),this.paused=!1,this.levels=[{ship:new g(this.audioListener),altitude:this.minAltitude,skyColor:new o.Color(13302001),decay:.03,coins:10},{ship:new M(this.audioListener),altitude:400,skyColor:new o.Color(11206655),decay:.06,coins:7},{ship:new y(this.audioListener),altitude:600,skyColor:new o.Color(0),decay:.12,coins:5}],this._camera=new o.PerspectiveCamera(70,window.innerWidth/window.innerHeight,1,1e3),this._camera.position.set(-100,50,0),this._camera.lookAt(0,0,100),this._camera.add(this.audioListener),this._scene=new o.Scene,this._renderer=new o.WebGLRenderer,this._renderer.setPixelRatio(window.devicePixelRatio),this._renderer.setSize(window.innerWidth,window.innerHeight),document.body.appendChild(this._renderer.domElement),this.stats=new l,this.stats.showPanel(0),document.body.appendChild(this.stats.dom);var i=new o.HemisphereLight(12303359,4473890);i.name="Hemisphere Light",i.position.set(0,1,0),t._scene.add(i);var s=new o.DirectionalLight(16777215);s.name="Point Light",s.position.set(-10,6,-10),t._scene.add(s),this.particles=new S(this._scene,this._camera);var n=new o.SphereGeometry(1,320,320),r=new o.MeshPhongMaterial({color:34816,emissive:65280});this.ground=new o.Mesh(n,r),this.ground.name="Ground",this._scene.add(this.ground);this.ground.scale.set(6e6,6e6,6e6),this.ground.position.y=-6e6,this.ground.rotation.z=.5*Math.PI;for(var u=0;u<this.levels.length;u++)this.levels[u].ship.on("onModelLoaded",function(e){t._scene.add(e)});this._renderer.domElement.addEventListener("mousemove",this.onMouseMove.bind(this),!1),this._renderer.domElement.addEventListener("mousedown",this.onMouseDown.bind(this),!1),this._renderer.domElement.addEventListener("mouseup",this.onMouseUp.bind(this),!1),this._renderer.domElement.addEventListener("touchstart",this.onMouseDown.bind(this),!1),this._renderer.domElement.addEventListener("touchend",this.onMouseUp.bind(this),!1),document.addEventListener("keydown",this.onKeyDown.bind(this),!1),document.addEventListener("keyup",this.onKeyUp.bind(this),!1),window.addEventListener("resize",this.onWindowResize.bind(this),!1),this.loadAudio(),this.animate()}return r()(e,[{key:"onMouseMove",value:function(e){this.mouseX=e.pageX,this.mouseY=e.pageY}},{key:"onMouseDown",value:function(){this.nextLevel(),this.altitude=this.levels[this.currentLevel].altitude+100}},{key:"onMouseUp",value:function(){}},{key:"onKeyDown",value:function(e){32===e.keyCode&&(this.paused=!this.paused)}},{key:"onKeyUp",value:function(e){}},{key:"onWindowResize",value:function(){this._camera.aspect=window.innerWidth/window.innerHeight,this._camera.updateProjectionMatrix(),this._renderer.setSize(window.innerWidth,window.innerHeight)}},{key:"animate",value:function(){if(this.stats.begin(),!this.paused){this.diffX+=(this.mouseX-this.prevMouseX)/100,this.diffY+=(this.mouseY-this.prevMouseY)/100,this.diffX=Math.clamp(this.diffX,-1,1),this.diffY=Math.clamp(this.diffY,-1,1),this.prevMouseX=this.mouseX,this.prevMouseY=this.mouseY,this.altitude-=this.levels[this.currentLevel].decay,this.altitude<this.minAltitude&&(this.altitude=this.minAltitude),this.curAltitude+=.05*(this.altitude-this.curAltitude);var e=this.currentLevel+1;e>=this.levels.length&&(e=this.currentLevel);var t=(this.altitude-this.levels[this.currentLevel].altitude)/(this.levels[e].altitude-this.levels[this.currentLevel].altitude);if(t=o.Math.clamp(t,0,1),this.coin.model)for(;this.coins.length<this.levels[this.currentLevel].coins&&Math.random()>.97;){var i=this.coin.model.clone();i.rotation.z=Math.random()*Math.PI,i.position.set(2*(Math.random()-.5)*this.maxX,Math.random()*(this.maxY-20)+20+this.curAltitude,this._camera.position.z+550+60*Math.random()),this._scene.add(i),this.coins.push(i)}for(var s=this.coins.length-1;s>=0;s--)this.coins[s].position.z<this._camera.position.z?this.removeCoin(this.coins[s]):this.coins[s].rotation.z+=.02;var a=this.levels[this.currentLevel].ship.model;if(a){var n=a.position.clone();this.destPos.x=Math.map(-this.diffX,-1,1,-this.maxX,this.maxX),this.destPos.y=Math.map(-this.diffY,-1,1,0,this.maxY)+this.curAltitude,a.position.x+=.05*(this.destPos.x-a.position.x),a.position.y+=.05*(this.destPos.y-a.position.y),a.position.z+=this.levels[this.currentLevel].ship.velocity*this.velX,this._camera.position.z=a.position.z-50,this._camera.position.y=this.curAltitude+50,this.ground.position.z=a.position.z;var r=new o.Vector3;r.subVectors(a.position,n),r.add(a.position),a.lookAt(r),a.rotation.y+=this.levels[this.currentLevel].ship.rotation;for(var l=a.position.clone().add(this.levels[this.currentLevel].ship.center),u=this.coins.length-1;u>=0;u--)l.distanceToSquared(this.coins[u].position)<200&&this.onResourceCollide(this.coins[u])}this.particles.update();var c=this.levels[this.currentLevel].skyColor.clone();c.lerp(this.levels[e].skyColor,t),this._scene.background=c,this._scene.fog=new o.FogExp2(c,.003),t<=0?this.prevLevel():t>=1&&this.nextLevel()}this._renderer.render(this._scene,this._camera),this.stats.end(),requestAnimationFrame(this.animate.bind(this))}},{key:"nextLevel",value:function(){var e=this.currentLevel+1;e>=this.levels.length&&(e=this.currentLevel),e!==this.currentLevel&&this.startLevel(e)}},{key:"prevLevel",value:function(){var e=this.currentLevel-1;e<=0&&(e=0),e!==this.currentLevel&&this.startLevel(e)}},{key:"startLevel",value:function(e){console.log("startLevel",e),this.levels[e].ship.model.position.copy(this.levels[this.currentLevel].ship.model.position),this.levels[this.currentLevel].ship.sound.isPlaying&&this.levels[this.currentLevel].ship.sound.stop(),this.currentLevel=e,this.levels[this.currentLevel].ship.sound.play()}},{key:"onResourceCollide",value:function(e){var t=20;this.curAltitude<this.altitude&&(t*=2),this.altitude+=t*(this.currentLevel+1),this.coin.sound.play(),this.removeCoin(e)}},{key:"removeCoin",value:function(e){var t=this.coins.indexOf(e);t>-1&&this.coins.splice(t,1),this._scene.remove(e)}},{key:"loadAudio",value:function(){var e=this;this.audioList=this.audioList.map(function(e){return{sort:Math.random(),value:e}}).sort(function(e,t){return e.sort-t.sort}).map(function(e){return e.value}),this.currentAudio=0;var t=-1,i=this;function s(){console.log("audio ended"),i.currentAudio++,i.currentAudio>=i.audioList.length&&(i.currentAudio=0),i.audioList[i.currentAudio].sound.play(),i.audioList[i.currentAudio].sound.source.onended=s}this.audioList.map(function(i){i.index=t++,i.sound=new o.Audio(e.audioListener),(new o.AudioLoader).load(i.url,function(e){i.sound.setBuffer(e),i.sound.setLoop(!1),i.sound.setVolume(.5),0===i.index&&(i.sound.play(),i.sound.source.onended=s)})})}}]),e}())},pTlp:function(e,t){},xkEE:function(e,t,i){"use strict";(function(e){const i=function(){function t(t){this.manager=void 0!==t?t:e.DefaultLoadingManager}t.prototype={constructor:t,crossOrigin:"Anonymous",load:function(t,i,s,a){var n=this,r=void 0!==this.path?this.path:e.LoaderUtils.extractUrlBase(t),o=new e.FileLoader(n.manager);o.setResponseType("arraybuffer"),o.load(t,function(e){try{n.parse(e,r,i,a)}catch(e){if(void 0===a)throw e;a(e)}},s,a)},setCrossOrigin:function(e){return this.crossOrigin=e,this},setPath:function(e){return this.path=e,this},parse:function(t,o,l,u){var c,d={};if("string"==typeof t)c=t;else if(e.LoaderUtils.decodeText(new Uint8Array(t,0,4))===a){try{d[i.KHR_BINARY_GLTF]=new function(t){this.name=i.KHR_BINARY_GLTF,this.content=null,this.body=null;var s=new DataView(t,0,n);if(this.header={magic:e.LoaderUtils.decodeText(new Uint8Array(t.slice(0,4))),version:s.getUint32(4,!0),length:s.getUint32(8,!0)},this.header.magic!==a)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected. Use LegacyGLTFLoader instead.");var o=new DataView(t,n),l=0;for(;l<o.byteLength;){var u=o.getUint32(l,!0);l+=4;var c=o.getUint32(l,!0);if(l+=4,c===r.JSON){var d=new Uint8Array(t,n+l,u);this.content=e.LoaderUtils.decodeText(d)}else if(c===r.BIN){var h=n+l;this.body=t.slice(h,h+u)}l+=u}if(null===this.content)throw new Error("THREE.GLTFLoader: JSON content not found.")}(t)}catch(e){return void(u&&u(e))}c=d[i.KHR_BINARY_GLTF].content}else c=e.LoaderUtils.decodeText(new Uint8Array(t));var h=JSON.parse(c);void 0===h.asset||h.asset.version[0]<2?u&&u(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported. Use LegacyGLTFLoader instead.")):(h.extensionsUsed&&(h.extensionsUsed.indexOf(i.KHR_LIGHTS)>=0&&(d[i.KHR_LIGHTS]=new function(t){this.name=i.KHR_LIGHTS,this.lights={};var s=(t.extensions&&t.extensions[i.KHR_LIGHTS]||{}).lights||{};for(var a in s){var n,r=s[a],o=(new e.Color).fromArray(r.color);switch(r.type){case"directional":(n=new e.DirectionalLight(o)).position.set(0,0,1);break;case"point":n=new e.PointLight(o);break;case"spot":(n=new e.SpotLight(o)).position.set(0,0,1);break;case"ambient":n=new e.AmbientLight(o)}n&&(void 0!==r.constantAttenuation&&(n.intensity=r.constantAttenuation),void 0!==r.linearAttenuation&&(n.distance=1/r.linearAttenuation),void 0!==r.quadraticAttenuation&&(n.decay=r.quadraticAttenuation),void 0!==r.fallOffAngle&&(n.angle=r.fallOffAngle),void 0!==r.fallOffExponent&&console.warn("THREE.GLTFLoader:: light.fallOffExponent not currently supported."),n.name=r.name||"light_"+a,this.lights[a]=n)}}(h)),h.extensionsUsed.indexOf(i.KHR_MATERIALS_COMMON)>=0&&(d[i.KHR_MATERIALS_COMMON]=new s(h)),h.extensionsUsed.indexOf(i.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS)>=0&&(d[i.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]=new function(){return{name:i.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS,specularGlossinessParams:["color","map","lightMap","lightMapIntensity","aoMap","aoMapIntensity","emissive","emissiveIntensity","emissiveMap","bumpMap","bumpScale","normalMap","displacementMap","displacementScale","displacementBias","specularMap","specular","glossinessMap","glossiness","alphaMap","envMap","envMapIntensity","refractionRatio"],getMaterialType:function(){return e.ShaderMaterial},extendParams:function(t,i,s){var a=i.extensions[this.name],n=e.ShaderLib.standard,r=e.UniformsUtils.clone(n.uniforms),o=["#ifdef USE_SPECULARMAP","\tuniform sampler2D specularMap;","#endif"].join("\n"),l=["#ifdef USE_GLOSSINESSMAP","\tuniform sampler2D glossinessMap;","#endif"].join("\n"),u=["vec3 specularFactor = specular;","#ifdef USE_SPECULARMAP","\tvec4 texelSpecular = texture2D( specularMap, vUv );","\ttexelSpecular = sRGBToLinear( texelSpecular );","\t// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture","\tspecularFactor *= texelSpecular.rgb;","#endif"].join("\n"),c=["float glossinessFactor = glossiness;","#ifdef USE_GLOSSINESSMAP","\tvec4 texelGlossiness = texture2D( glossinessMap, vUv );","\t// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture","\tglossinessFactor *= texelGlossiness.a;","#endif"].join("\n"),d=["PhysicalMaterial material;","material.diffuseColor = diffuseColor.rgb;","material.specularRoughness = clamp( 1.0 - glossinessFactor, 0.04, 1.0 );","material.specularColor = specularFactor.rgb;"].join("\n"),h=n.fragmentShader.replace("#include <specularmap_fragment>","").replace("uniform float roughness;","uniform vec3 specular;").replace("uniform float metalness;","uniform float glossiness;").replace("#include <roughnessmap_pars_fragment>",o).replace("#include <metalnessmap_pars_fragment>",l).replace("#include <roughnessmap_fragment>",u).replace("#include <metalnessmap_fragment>",c).replace("#include <lights_physical_fragment>",d);delete r.roughness,delete r.metalness,delete r.roughnessMap,delete r.metalnessMap,r.specular={value:(new e.Color).setHex(1118481)},r.glossiness={value:.5},r.specularMap={value:null},r.glossinessMap={value:null},t.vertexShader=n.vertexShader,t.fragmentShader=h,t.uniforms=r,t.defines={STANDARD:""},t.color=new e.Color(1,1,1),t.opacity=1;var p=[];if(Array.isArray(a.diffuseFactor)){var m=a.diffuseFactor;t.color.fromArray(m),t.opacity=m[3]}if(void 0!==a.diffuseTexture&&p.push(s.assignTexture(t,"map",a.diffuseTexture.index)),t.emissive=new e.Color(0,0,0),t.glossiness=void 0!==a.glossinessFactor?a.glossinessFactor:1,t.specular=new e.Color(1,1,1),Array.isArray(a.specularFactor)&&t.specular.fromArray(a.specularFactor),void 0!==a.specularGlossinessTexture){var f=a.specularGlossinessTexture.index;p.push(s.assignTexture(t,"glossinessMap",f)),p.push(s.assignTexture(t,"specularMap",f))}return Promise.all(p)},createMaterial:function(t){var i=new e.ShaderMaterial({defines:t.defines,vertexShader:t.vertexShader,fragmentShader:t.fragmentShader,uniforms:t.uniforms,fog:!0,lights:!0,opacity:t.opacity,transparent:t.transparent});return i.isGLTFSpecularGlossinessMaterial=!0,i.color=t.color,i.map=void 0===t.map?null:t.map,i.lightMap=null,i.lightMapIntensity=1,i.aoMap=void 0===t.aoMap?null:t.aoMap,i.aoMapIntensity=1,i.emissive=t.emissive,i.emissiveIntensity=1,i.emissiveMap=void 0===t.emissiveMap?null:t.emissiveMap,i.bumpMap=void 0===t.bumpMap?null:t.bumpMap,i.bumpScale=1,i.normalMap=void 0===t.normalMap?null:t.normalMap,t.normalScale&&(i.normalScale=t.normalScale),i.displacementMap=null,i.displacementScale=1,i.displacementBias=0,i.specularMap=void 0===t.specularMap?null:t.specularMap,i.specular=t.specular,i.glossinessMap=void 0===t.glossinessMap?null:t.glossinessMap,i.glossiness=t.glossiness,i.alphaMap=null,i.envMap=void 0===t.envMap?null:t.envMap,i.envMapIntensity=1,i.refractionRatio=.98,i.extensions.derivatives=!0,i},cloneMaterial:function(e){var t=e.clone();t.isGLTFSpecularGlossinessMaterial=!0;for(var i=this.specularGlossinessParams,s=0,a=i.length;s<a;s++)t[i[s]]=e[i[s]];return t},refreshUniforms:function(e,t,i,s,a,n){var r,o,l,u=a.uniforms,c=a.defines;if(u.opacity.value=a.opacity,u.diffuse.value.copy(a.color),u.emissive.value.copy(a.emissive).multiplyScalar(a.emissiveIntensity),u.map.value=a.map,u.specularMap.value=a.specularMap,u.alphaMap.value=a.alphaMap,u.lightMap.value=a.lightMap,u.lightMapIntensity.value=a.lightMapIntensity,u.aoMap.value=a.aoMap,u.aoMapIntensity.value=a.aoMapIntensity,a.map?r=a.map:a.specularMap?r=a.specularMap:a.displacementMap?r=a.displacementMap:a.normalMap?r=a.normalMap:a.bumpMap?r=a.bumpMap:a.glossinessMap?r=a.glossinessMap:a.alphaMap?r=a.alphaMap:a.emissiveMap&&(r=a.emissiveMap),void 0!==r)if(r.isWebGLRenderTarget&&(r=r.texture),void 0!==r.matrix){if(!0===r.matrixAutoUpdate){o=r.offset,l=r.repeat;var d=r.rotation,h=r.center;r.matrix.setUvTransform(o.x,o.y,l.x,l.y,d,h.x,h.y)}u.uvTransform.value.copy(r.matrix)}else o=r.offset,l=r.repeat,u.offsetRepeat.value.set(o.x,o.y,l.x,l.y);u.envMap.value=a.envMap,u.envMapIntensity.value=a.envMapIntensity,u.flipEnvMap.value=a.envMap&&a.envMap.isCubeTexture?-1:1,u.refractionRatio.value=a.refractionRatio,u.specular.value.copy(a.specular),u.glossiness.value=a.glossiness,u.glossinessMap.value=a.glossinessMap,u.emissiveMap.value=a.emissiveMap,u.bumpMap.value=a.bumpMap,u.normalMap.value=a.normalMap,u.displacementMap.value=a.displacementMap,u.displacementScale.value=a.displacementScale,u.displacementBias.value=a.displacementBias,null!==u.glossinessMap.value&&void 0===c.USE_GLOSSINESSMAP&&(c.USE_GLOSSINESSMAP="",c.USE_ROUGHNESSMAP=""),null===u.glossinessMap.value&&void 0!==c.USE_GLOSSINESSMAP&&(delete c.USE_GLOSSINESSMAP,delete c.USE_ROUGHNESSMAP)}}})),new b(h,d,{path:o||this.path||"",crossOrigin:this.crossOrigin,manager:this.manager}).parse(function(e,t,i,s,a){l({scene:e,scenes:t,cameras:i,animations:s,asset:a})},u))}};var i={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_LIGHTS:"KHR_lights",KHR_MATERIALS_COMMON:"KHR_materials_common",KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:"KHR_materials_pbrSpecularGlossiness"};function s(e){this.name=i.KHR_MATERIALS_COMMON}s.prototype.getMaterialType=function(t){switch(t.extensions[this.name].type){case"commonBlinn":case"commonPhong":return e.MeshPhongMaterial;case"commonLambert":return e.MeshLambertMaterial;case"commonConstant":default:return e.MeshBasicMaterial}},s.prototype.extendParams=function(t,i,s){var a=i.extensions[this.name],n=[],r=[];switch(a.type){case"commonBlinn":case"commonPhong":r.push("diffuseFactor","diffuseTexture","specularFactor","specularTexture","shininessFactor");break;case"commonLambert":r.push("diffuseFactor","diffuseTexture")}var o={};return r.forEach(function(e){void 0!==a[e]&&(o[e]=a[e])}),void 0!==o.diffuseFactor&&(t.color=(new e.Color).fromArray(o.diffuseFactor),t.opacity=o.diffuseFactor[3]),void 0!==o.diffuseTexture&&n.push(s.assignTexture(t,"map",o.diffuseTexture.index)),void 0!==o.specularFactor&&(t.specular=(new e.Color).fromArray(o.specularFactor)),void 0!==o.specularTexture&&n.push(s.assignTexture(t,"specularMap",o.specularTexture.index)),void 0!==o.shininessFactor&&(t.shininess=o.shininessFactor),Promise.all(n)};var a="glTF",n=12,r={JSON:1313821514,BIN:5130562};var o=0,l=1,u=2,c=3,d=4,h=5,p=6,m=(Number,e.Matrix3,e.Matrix4,e.Vector2,e.Vector3,e.Vector4,e.Texture,{5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array}),f={9728:e.NearestFilter,9729:e.LinearFilter,9984:e.NearestMipMapNearestFilter,9985:e.LinearMipMapNearestFilter,9986:e.NearestMipMapLinearFilter,9987:e.LinearMipMapLinearFilter},v={33071:e.ClampToEdgeWrapping,33648:e.MirroredRepeatWrapping,10497:e.RepeatWrapping},g={6406:e.AlphaFormat,6407:e.RGBFormat,6408:e.RGBAFormat,6409:e.LuminanceFormat,6410:e.LuminanceAlphaFormat},M={5121:e.UnsignedByteType,32819:e.UnsignedShort4444Type,32820:e.UnsignedShort5551Type,33635:e.UnsignedShort565Type},y=(e.BackSide,e.FrontSide,e.NeverDepth,e.LessDepth,e.EqualDepth,e.LessEqualDepth,e.GreaterEqualDepth,e.NotEqualDepth,e.GreaterEqualDepth,e.AlwaysDepth,e.AddEquation,e.SubtractEquation,e.ReverseSubtractEquation,e.ZeroFactor,e.OneFactor,e.SrcColorFactor,e.OneMinusSrcColorFactor,e.SrcAlphaFactor,e.OneMinusSrcAlphaFactor,e.DstAlphaFactor,e.OneMinusDstAlphaFactor,e.DstColorFactor,e.OneMinusDstColorFactor,e.SrcAlphaSaturateFactor,{SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16}),L={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},S={CUBICSPLINE:e.InterpolateSmooth,LINEAR:e.InterpolateLinear,STEP:e.InterpolateDiscrete},w="OPAQUE",_="MASK",x="BLEND";function A(e,t){return"string"!=typeof e||""===e?"":/^(https?:)?\/\//i.test(e)?e:/^data:.*,.*$/i.test(e)?e:/^blob:.*$/i.test(e)?e:t+e}function T(e,t,i,s){var a=e.geometry,n=e.material,r=i.targets,o=a.morphAttributes;o.position=[],o.normal=[],n.morphTargets=!0;for(var l=0,u=r.length;l<u;l++){var c,d,h=r[l],p="morphTarget"+l;if(void 0!==h.POSITION){c=s[h.POSITION].clone();for(var m=a.attributes.position,f=0,v=c.count;f<v;f++)c.setXYZ(f,c.getX(f)+m.getX(f),c.getY(f)+m.getY(f),c.getZ(f)+m.getZ(f))}else a.attributes.position&&(c=a.attributes.position.clone());if(void 0!==c&&(c.name=p,o.position.push(c)),void 0!==h.NORMAL){n.morphNormals=!0,d=s[h.NORMAL].clone();var g=a.attributes.normal;for(f=0,v=d.count;f<v;f++)d.setXYZ(f,d.getX(f)+g.getX(f),d.getY(f)+g.getY(f),d.getZ(f)+g.getZ(f))}else void 0!==a.attributes.normal&&(d=a.attributes.normal.clone());void 0!==d&&(d.name=p,o.normal.push(d))}if(e.updateMorphTargets(),void 0!==t.weights)for(l=0,u=t.weights.length;l<u;l++)e.morphTargetInfluences[l]=t.weights[l]}function R(e,t){if(e.indices!==t.indices)return!1;var i=e.attributes||{},s=t.attributes||{},a=Object.keys(i),n=Object.keys(s);if(a.length!==n.length)return!1;for(var r=0,o=a.length;r<o;r++){var l=a[r];if(i[l]!==s[l])return!1}return!0}function E(e,t){for(var i=0,s=e.length;i<s;i++){var a=e[i];if(R(a.primitive,t))return a.geometry}return null}function b(t,i,s){this.json=t||{},this.extensions=i||{},this.options=s||{},this.cache=new function(){var e={};return{get:function(t){return e[t]},add:function(t,i){e[t]=i},remove:function(t){delete e[t]},removeAll:function(){e={}}}},this.primitiveCache=[],this.textureLoader=new e.TextureLoader(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.fileLoader=new e.FileLoader(this.options.manager),this.fileLoader.setResponseType("arraybuffer")}return b.prototype.parse=function(e,t){var i=this.json;this.cache.removeAll(),this.markDefs(),this.getMultiDependencies(["scene","animation","camera"]).then(function(t){var s=t.scenes||[],a=s[i.scene||0],n=t.animations||[],r=i.asset,o=t.cameras||[];e(a,s,o,n,r)}).catch(t)},b.prototype.markDefs=function(){for(var e=this.json.nodes||[],t=this.json.skins||[],i=this.json.meshes||[],s={},a={},n=0,r=t.length;n<r;n++)for(var o=t[n].joints,l=0,u=o.length;l<u;l++)e[o[l]].isBone=!0;for(var c=0,d=e.length;c<d;c++){var h=e[c];void 0!==h.mesh&&(void 0===s[h.mesh]&&(s[h.mesh]=a[h.mesh]=0),s[h.mesh]++,void 0!==h.skin&&(i[h.mesh].isSkinnedMesh=!0))}this.json.meshReferences=s,this.json.meshUses=a},b.prototype.getDependency=function(e,t){var i=e+":"+t,s=this.cache.get(i);s||(s=this["load"+e.charAt(0).toUpperCase()+e.slice(1)](t),this.cache.add(i,s));return s},b.prototype.getDependencies=function(e){var t=this.cache.get(e);if(!t){var i=this,s=this.json[e+("mesh"===e?"es":"s")]||[];t=Promise.all(s.map(function(t,s){return i.getDependency(e,s)})),this.cache.add(e,t)}return t},b.prototype.getMultiDependencies=function(e){for(var t={},i=[],s=0,a=e.length;s<a;s++){var n=e[s],r=this.getDependencies(n);r=r.then(function(e,i){t[e]=i}.bind(this,n+("mesh"===n?"es":"s"))),i.push(r)}return Promise.all(i).then(function(){return t})},b.prototype.loadBuffer=function(e){var t=this.json.buffers[e],s=this.fileLoader;if(t.type&&"arraybuffer"!==t.type)throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(void 0===t.uri&&0===e)return Promise.resolve(this.extensions[i.KHR_BINARY_GLTF].body);var a=this.options;return new Promise(function(e,i){s.load(A(t.uri,a.path),e,void 0,function(){i(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))})})},b.prototype.loadBufferView=function(e){var t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then(function(e){var i=t.byteLength||0,s=t.byteOffset||0;return e.slice(s,s+i)})},b.prototype.loadAccessor=function(t){var i=this.json,s=this.json.accessors[t],a=[];return void 0!==s.bufferView?a.push(this.getDependency("bufferView",s.bufferView)):a.push(null),void 0!==s.sparse&&(a.push(this.getDependency("bufferView",s.sparse.indices.bufferView)),a.push(this.getDependency("bufferView",s.sparse.values.bufferView))),Promise.all(a).then(function(t){var a,n,r=t[0],o=y[s.type],l=m[s.componentType],u=l.BYTES_PER_ELEMENT,c=u*o,d=i.bufferViews[s.bufferView].byteStride,h=!0===s.normalized;if(d&&d!==c){a=new l(r);var p=new e.InterleavedBuffer(a,d/u);n=new e.InterleavedBufferAttribute(p,o,s.byteOffset/u,h)}else a=null===r?new l(s.count*o):new l(r,s.byteOffset,s.count*o),n=new e.BufferAttribute(a,o,h);if(void 0!==s.sparse){var f=y.SCALAR,v=m[s.sparse.indices.componentType],g=s.sparse.indices.byteOffset||0,M=s.sparse.values.byteOffset||0,L=new v(t[1],g,s.sparse.count*f),S=new l(t[2],M,s.sparse.count*o);null!==r&&n.setArray(n.array.slice());for(var w=0,_=L.length;w<_;w++){var x=L[w];if(n.setX(x,S[w*o]),o>=2&&n.setY(x,S[w*o+1]),o>=3&&n.setZ(x,S[w*o+2]),o>=4&&n.setW(x,S[w*o+3]),o>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return n})},b.prototype.loadTexture=function(t){var i=this.json,s=this.options,a=this.textureLoader,n=window.URL||window.webkitURL,r=i.textures[t],o=i.images[r.source],l=o.uri,u=!1;return void 0!==o.bufferView&&(l=this.getDependency("bufferView",o.bufferView).then(function(e){u=!0;var t=new Blob([e],{type:o.mimeType});return l=n.createObjectURL(t)})),Promise.resolve(l).then(function(t){var i=e.Loader.Handlers.get(t)||a;return new Promise(function(e,a){i.load(A(t,s.path),e,void 0,a)})}).then(function(t){!0===u&&n.revokeObjectURL(l),t.flipY=!1,void 0!==r.name&&(t.name=r.name),t.format=void 0!==r.format?g[r.format]:e.RGBAFormat,void 0!==r.internalFormat&&t.format!==g[r.internalFormat]&&console.warn("THREE.GLTFLoader: Three.js does not support texture internalFormat which is different from texture format. internalFormat will be forced to be the same value as format."),t.type=void 0!==r.type?M[r.type]:e.UnsignedByteType;var s=(i.samplers||{})[r.sampler]||{};return t.magFilter=f[s.magFilter]||e.LinearFilter,t.minFilter=f[s.minFilter]||e.LinearMipMapLinearFilter,t.wrapS=v[s.wrapS]||e.RepeatWrapping,t.wrapT=v[s.wrapT]||e.RepeatWrapping,t})},b.prototype.assignTexture=function(e,t,i){return this.getDependency("texture",i).then(function(i){e[t]=i})},b.prototype.loadMaterial=function(t){this.json;var s,a=this.extensions,n=this.json.materials[t],r={},o=n.extensions||{},l=[];if(o[i.KHR_MATERIALS_COMMON]){var u=a[i.KHR_MATERIALS_COMMON];s=u.getMaterialType(n),l.push(u.extendParams(r,n,this))}else if(o[i.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]){var c=a[i.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS];s=c.getMaterialType(n),l.push(c.extendParams(r,n,this))}else if(void 0!==n.pbrMetallicRoughness){s=e.MeshStandardMaterial;var d=n.pbrMetallicRoughness;if(r.color=new e.Color(1,1,1),r.opacity=1,Array.isArray(d.baseColorFactor)){var h=d.baseColorFactor;r.color.fromArray(h),r.opacity=h[3]}if(void 0!==d.baseColorTexture&&l.push(this.assignTexture(r,"map",d.baseColorTexture.index)),r.metalness=void 0!==d.metallicFactor?d.metallicFactor:1,r.roughness=void 0!==d.roughnessFactor?d.roughnessFactor:1,void 0!==d.metallicRoughnessTexture){var p=d.metallicRoughnessTexture.index;l.push(this.assignTexture(r,"metalnessMap",p)),l.push(this.assignTexture(r,"roughnessMap",p))}}else s=e.MeshPhongMaterial;!0===n.doubleSided&&(r.side=e.DoubleSide);var m=n.alphaMode||w;return m===x?r.transparent=!0:(r.transparent=!1,m===_&&(r.alphaTest=void 0!==n.alphaCutoff?n.alphaCutoff:.5)),void 0!==n.normalTexture&&(l.push(this.assignTexture(r,"normalMap",n.normalTexture.index)),r.normalScale=new e.Vector2(1,1),void 0!==n.normalTexture.scale&&r.normalScale.set(n.normalTexture.scale,n.normalTexture.scale)),void 0!==n.occlusionTexture&&(l.push(this.assignTexture(r,"aoMap",n.occlusionTexture.index)),void 0!==n.occlusionTexture.strength&&(r.aoMapIntensity=n.occlusionTexture.strength)),void 0!==n.emissiveFactor&&(s===e.MeshBasicMaterial?r.color=(new e.Color).fromArray(n.emissiveFactor):r.emissive=(new e.Color).fromArray(n.emissiveFactor)),void 0!==n.emissiveTexture&&(s===e.MeshBasicMaterial?l.push(this.assignTexture(r,"map",n.emissiveTexture.index)):l.push(this.assignTexture(r,"emissiveMap",n.emissiveTexture.index))),Promise.all(l).then(function(){var t;return t=s===e.ShaderMaterial?a[i.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].createMaterial(r):new s(r),void 0!==n.name&&(t.name=n.name),t.normalScale&&(t.normalScale.x=-t.normalScale.x),t.map&&(t.map.encoding=e.sRGBEncoding),t.emissiveMap&&(t.emissiveMap.encoding=e.sRGBEncoding),n.extras&&(t.userData=n.extras),t})},b.prototype.loadGeometries=function(t){var i=this.primitiveCache;return this.getDependencies("accessor").then(function(s){for(var a=[],n=0,r=t.length;n<r;n++){var o=t[n],l=E(i,o);if(l)a.push(l);else{var u=new e.BufferGeometry,c=o.attributes;for(var d in c){var h=s[c[d]];switch(d){case"POSITION":u.addAttribute("position",h);break;case"NORMAL":u.addAttribute("normal",h);break;case"TEXCOORD_0":case"TEXCOORD0":case"TEXCOORD":u.addAttribute("uv",h);break;case"TEXCOORD_1":u.addAttribute("uv2",h);break;case"COLOR_0":case"COLOR0":case"COLOR":u.addAttribute("color",h);break;case"WEIGHTS_0":case"WEIGHT":u.addAttribute("skinWeight",h);break;case"JOINTS_0":case"JOINT":u.addAttribute("skinIndex",h)}}void 0!==o.indices&&u.setIndex(s[o.indices]),i.push({primitive:o,geometry:u}),a.push(u)}}return a})},b.prototype.loadMesh=function(t){var s=this,a=(this.json,this.extensions),n=this.json.meshes[t];return this.getMultiDependencies(["accessor","material"]).then(function(r){var m=new e.Group,f=n.primitives;return s.loadGeometries(f).then(function(s){for(var v=0,g=f.length;v<g;v++){var M=f[v],y=s[v],L=void 0===M.material?new e.MeshStandardMaterial({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:e.FrontSide}):r.materials[M.material];L.aoMap&&void 0===y.attributes.uv2&&void 0!==y.attributes.uv&&(console.log("THREE.GLTFLoader: Duplicating UVs to support aoMap."),y.addAttribute("uv2",new e.BufferAttribute(y.attributes.uv.array,2)));var S,w=void 0!==y.attributes.color,_=void 0===y.attributes.normal,x=!0===n.isSkinnedMesh,A=void 0!==M.targets;if(w||_||x||A)if(L.isGLTFSpecularGlossinessMaterial)L=a[i.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].cloneMaterial(L);else L=L.clone();if(w&&(L.vertexColors=e.VertexColors,L.needsUpdate=!0),_&&(L.flatShading=!0),M.mode===d||M.mode===h||M.mode===p||void 0===M.mode)x?(S=new e.SkinnedMesh(y,L),L.skinning=!0):S=new e.Mesh(y,L),M.mode===h?S.drawMode=e.TriangleStripDrawMode:M.mode===p&&(S.drawMode=e.TriangleFanDrawMode);else if(M.mode===l)S=new e.LineSegments(y,L);else if(M.mode===c)S=new e.Line(y,L);else if(M.mode===u)S=new e.LineLoop(y,L);else{if(M.mode!==o)throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+M.mode);S=new e.Points(y,L)}if(S.name=n.name||"mesh_"+t,A&&T(S,n,M,r.accessors),void 0!==n.extras&&(S.userData=n.extras),void 0!==M.extras&&(S.geometry.userData=M.extras),!0===L.isGLTFSpecularGlossinessMaterial&&(S.onBeforeRender=a[i.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].refreshUniforms),!(f.length>1))return S;S.name+="_"+v,m.add(S)}return m})})},b.prototype.loadCamera=function(t){var i,s=this.json.cameras[t],a=s[s.type];if(a){if("perspective"===s.type){var n=a.aspectRatio||1,r=a.yfov*n;i=new e.PerspectiveCamera(e.Math.radToDeg(r),n,a.znear||1,a.zfar||2e6)}else"orthographic"===s.type&&(i=new e.OrthographicCamera(a.xmag/-2,a.xmag/2,a.ymag/2,a.ymag/-2,a.znear,a.zfar));return void 0!==s.name&&(i.name=s.name),s.extras&&(i.userData=s.extras),Promise.resolve(i)}console.warn("THREE.GLTFLoader: Missing camera parameters.")},b.prototype.loadSkin=function(e){var t=this.json.skins[e],i={joints:t.joints};return void 0===t.inverseBindMatrices?Promise.resolve(i):this.getDependency("accessor",t.inverseBindMatrices).then(function(e){return i.inverseBindMatrices=e,i})},b.prototype.loadAnimation=function(t){this.json;var i=this.json.animations[t];return this.getMultiDependencies(["accessor","node"]).then(function(s){for(var a=[],n=0,r=i.channels.length;n<r;n++){var o=i.channels[n],l=i.samplers[o.sampler];if(l){var u=o.target,c=void 0!==u.node?u.node:u.id,d=void 0!==i.parameters?i.parameters[l.input]:l.input,h=void 0!==i.parameters?i.parameters[l.output]:l.output,p=s.accessors[d],m=s.accessors[h],f=s.nodes[c];if(f){var v;switch(f.updateMatrix(),f.matrixAutoUpdate=!0,L[u.path]){case L.weights:v=e.NumberKeyframeTrack;break;case L.rotation:v=e.QuaternionKeyframeTrack;break;case L.position:case L.scale:default:v=e.VectorKeyframeTrack}var g=f.name?f.name:f.uuid;if("CUBICSPLINE"===l.interpolation){for(var M=m.itemSize,y=new(0,m.array.constructor)(m.count*M/3),w=0,_=m.count;w<_;w+=3)y[w*M/3]=m.getX(w+1),M>1&&(y[w*M/3+1]=m.getY(w+1)),M>2&&(y[w*M/3+2]=m.getZ(w+1)),M>3&&(y[w*M/3+3]=m.getW(w+1));m=new e.BufferAttribute(y,M/3,m.normalized)}var x=void 0!==l.interpolation?S[l.interpolation]:e.InterpolateLinear,A=[];L[u.path]===L.weights?f.traverse(function(e){!0===e.isMesh&&!0===e.material.morphTargets&&A.push(e.name?e.name:e.uuid)}):A.push(g);for(w=0,_=A.length;w<_;w++)a.push(new v(A[w]+"."+L[u.path],e.AnimationUtils.arraySlice(p.array,0),e.AnimationUtils.arraySlice(m.array,0),x))}}}c=void 0!==i.name?i.name:"animation_"+t;return new e.AnimationClip(c,void 0,a)})},b.prototype.loadNode=function(t){this.json;var s=this.extensions,a=this.json.meshReferences,n=this.json.meshUses,r=this.json.nodes[t];return this.getMultiDependencies(["mesh","skin","camera"]).then(function(t){var o;if(!0===r.isBone)o=new e.Bone;else if(void 0!==r.mesh){var l=t.meshes[r.mesh];if(o=l.clone(),!0===l.isGroup)for(var u=0,c=l.children.length;u<c;u++){var d=l.children[u];d.material&&!0===d.material.isGLTFSpecularGlossinessMaterial&&(o.children[u].onBeforeRender=d.onBeforeRender)}else l.material&&!0===l.material.isGLTFSpecularGlossinessMaterial&&(o.onBeforeRender=l.onBeforeRender);a[r.mesh]>1&&(o.name+="_instance_"+n[r.mesh]++)}else if(void 0!==r.camera)o=t.cameras[r.camera];else if(r.extensions&&r.extensions[i.KHR_LIGHTS]&&void 0!==r.extensions[i.KHR_LIGHTS].light){o=s[i.KHR_LIGHTS].lights[r.extensions[i.KHR_LIGHTS].light]}else o=new e.Object3D;if(void 0!==r.name&&(o.name=e.PropertyBinding.sanitizeNodeName(r.name)),r.extras&&(o.userData=r.extras),void 0!==r.matrix){var h=new e.Matrix4;h.fromArray(r.matrix),o.applyMatrix(h)}else void 0!==r.translation&&o.position.fromArray(r.translation),void 0!==r.rotation&&o.quaternion.fromArray(r.rotation),void 0!==r.scale&&o.scale.fromArray(r.scale);return o})},b.prototype.loadScene=function(){function t(i,s,a,n,r){var o=n[i],l=a.nodes[i];if(void 0!==l.skin)for(var u=!0===o.isGroup?o.children:[o],c=0,d=u.length;c<d;c++){for(var h=u[c],p=r[l.skin],m=[],f=[],v=0,g=p.joints.length;v<g;v++){var M=p.joints[v],y=n[M];if(y){m.push(y);var L=new e.Matrix4;void 0!==p.inverseBindMatrices&&L.fromArray(p.inverseBindMatrices.array,16*v),f.push(L)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',M)}h.bind(new e.Skeleton(m,f),h.matrixWorld)}if(s.add(o),l.children){var S=l.children;for(c=0,d=S.length;c<d;c++){t(S[c],o,a,n,r)}}}return function(s){var a=this.json,n=this.extensions,r=this.json.scenes[s];return this.getMultiDependencies(["node","skin"]).then(function(s){var o=new e.Scene;void 0!==r.name&&(o.name=r.name),r.extras&&(o.userData=r.extras);for(var l=r.nodes||[],u=0,c=l.length;u<c;u++)t(l[u],o,a,s.nodes,s.skins);if(r.extensions&&r.extensions[i.KHR_LIGHTS]&&void 0!==r.extensions[i.KHR_LIGHTS].light){var d=n[i.KHR_LIGHTS].lights;o.add(d[r.extensions[i.KHR_LIGHTS].light])}return o})}}(),t}();t.a=i}).call(t,i("Ml+6"))}},["eslX"]);
//# sourceMappingURL=app.3ae5eb578c57766bd9cb.js.map